<?xml version="1.0" encoding="utf-8"?>
<Page
  x:Class="winui_local_movie.AllVideosPage"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:local="using:winui_local_movie"
  mc:Ignorable="d">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="320"/>
        </Grid.ColumnDefinitions>

        <Grid Grid.Column="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid Grid.Row="0"
            Margin="10"
            HorizontalAlignment="Stretch">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <!-- å·¦ä¾§å¯¼èˆªæŒ‰é’® -->
                    <ColumnDefinition Width="*"/>
                    <!-- ä¸­é—´å ä½ç©ºç™½ -->
                    <ColumnDefinition Width="Auto"/>
                    <!-- å³ä¾§æŽ’åºæŽ§ä»¶ -->
                </Grid.ColumnDefinitions>

                <!-- å¯¼èˆªæŒ‰é’® -->
                <StackPanel Grid.Column="0"
                    Orientation="Horizontal">
                    <Button x:Name="AllVideosButton"
                  Content="å…¨éƒ¨è§†é¢‘"
                  Click="FilterButton_Click"
                  Tag="All"
                  Style="{StaticResource AccentButtonStyle}"
                  Margin="0,0,5,0"/>
                    <Button x:Name="FavoritesButton"
                  Content="æˆ‘çš„å–œæ¬¢"
                  Click="FilterButton_Click"
                  Tag="Favorites"
                  Margin="5,0"/>
                    <Button x:Name="WatchLaterButton"
                  Content="ç¨åŽå†çœ‹"
                  Click="FilterButton_Click"
                  Tag="WatchLater"
                  Margin="5,0"/>
                    <Button x:Name="MultiSelectButton"
                  Content="å¤šé€‰"
                  Click="MultiSelectButton_Click"
                  Margin="5,0"/>
                    <Button x:Name="ExitMultiSelectButton"
                  Content="é€€å‡ºå¤šé€‰"
                  Click="ExitMultiSelectButton_Click"
                  Visibility="Collapsed"
                  Margin="5,0"/>
                </StackPanel>
                <!-- åœ¨çŽ°æœ‰å¯¼èˆªæŒ‰é’® StackPanel åŽé¢æ·»åŠ  -->
                <StackPanel Grid.Column="1"
                    Orientation="Horizontal"
                    HorizontalAlignment="Center">
                    <AutoSuggestBox x:Name="SearchBox"
                          PlaceholderText="æœç´¢è§†é¢‘..."
                          QueryIcon="Find"
                          Width="300"
                          Height="32"
                          MinWidth="200"
                          TextChanged="SearchBox_TextChanged"
                          QuerySubmitted="SearchBox_QuerySubmitted"
                          Margin="10,0"
                          VerticalAlignment="Center"/>
                </StackPanel>
                <!-- æŽ’åºæŽ§ä»¶ -->
                <StackPanel Grid.Column="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="20,0,0,0">
                    <Button x:Name="BulkDeleteButton"
                  Content="åˆ é™¤æ–‡ä»¶"
                  Click="BulkDeleteButton_Click"
                  Visibility="Collapsed"
                  Margin="5,0"/>
                    <Button x:Name="BulkRefreshMetadataButton"
                  Content="åˆ·æ–°å…ƒæ•°æ®"
                  Click="BulkRefreshMetadataButton_Click"
                  Visibility="Collapsed"
                  Margin="5,0"/>
                    <ComboBox x:Name="SortPropertyComboBox"
                    Header="æŽ’åºå±žæ€§"
                    SelectionChanged="SortPropertyComboBox_SelectionChanged"
                    MinWidth="120"
                    Margin="5,0">
                        <ComboBoxItem Content="åŠ å…¥æ—¶é—´"
                          Tag="DateAdded"
                          IsSelected="True"/>
                        <ComboBoxItem Content="æ–‡ä»¶å¤§å°"
                          Tag="FileSize"/>
                        <ComboBoxItem Content="åˆ›å»ºæ—¶é—´"
                          Tag="CreationDate"/>
                        <ComboBoxItem Content="æ—¶é•¿"
                          Tag="Duration"/>
                    </ComboBox>

                    <ComboBox x:Name="SortOrderComboBox"
                    Header="æŽ’åºæ–¹å‘"
                    SelectionChanged="SortOrderComboBox_SelectionChanged"
                    MinWidth="100"
                    Margin="5,0">
                        <ComboBoxItem Content="é™åº"
                          Tag="DESC"
                          IsSelected="True"/>
                        <ComboBoxItem Content="å‡åº"
                          Tag="ASC"/>
                    </ComboBox>

                    <Button Content="åº”ç”¨æŽ’åº"
                  Click="ApplySortButton_Click"
                  Margin="10,0"
                  VerticalAlignment="Bottom"/>
                </StackPanel>
            </Grid>


            <!-- è§†é¢‘åˆ—è¡¨ -->
            <GridView x:Name="VideosGridView"
                Grid.Row="1"
                SelectionMode="Extended"
                IsItemClickEnabled="True"
                CanDragItems="True"
                PointerPressed="VideosGridView_PointerPressed"
                DragItemsStarting="VideosGridView_DragItemsStarting"
                ItemClick="VideosGridView_ItemClick"
                SelectionChanged="VideosGridView_SelectionChanged">
                <GridView.ItemTemplate>
                    <DataTemplate x:DataType="local:VideoModel">
                        <StackPanel Width="220"
                        Margin="5"
                        Background="{ThemeResource SystemControlBackgroundAltHighBrush}">

                            <!-- ä¸Šæ–¹ç¼©ç•¥å›¾åŒºåŸŸ -->
                            <Border Background="LightGray"
                      Height="125"
                      Tapped="Thumbnail_Tapped">
                                <Grid>
                                    <Image Source="{x:Bind GetThumbnailPath(FilePath)}"
                         Stretch="UniformToFill"
                         HorizontalAlignment="Center"
                         VerticalAlignment="Center"/>
                                    <Button Width="28"
                          Height="28"
                          Padding="0"
                          Margin="6"
                          HorizontalAlignment="Right"
                          VerticalAlignment="Top"
                          Click="AddToTempListButton_Click"
                          Tag="{x:Bind}">
                                        <SymbolIcon Symbol="Add"/>
                                    </Button>
                                </Grid>
                            </Border>

                            <!-- ä¸‹æ–¹æŒ‰é’®åŒºåŸŸ -->
                            <StackPanel Orientation="Horizontal"
                          HorizontalAlignment="Center"
                          Margin="0,5,0,0">
                                <Button Content="{x:Bind GetFavoriteIcon(IsFavorite)}"
                        Foreground="{x:Bind GetFavoriteColor(IsFavorite)}"
                        FontSize="12"
                        Width="40"
                        Height="40"
                        Margin="2"
                        Click="FavoriteButton_Click"
                        Tag="{x:Bind}"
                        Name="FavoriteBtn"/>

                                <!-- ä¿®æ”¹ç¨åŽå†çœ‹æŒ‰é’® -->
                                <Button Content="{x:Bind GetWatchLaterIcon(IsWatchLater)}"
                        Foreground="{x:Bind GetWatchLaterColor(IsWatchLater)}"
                        FontSize="12"
                        Width="40"
                        Height="40"
                        Margin="2"
                        Click="WatchLaterButton_Click"
                        Tag="{x:Bind}"
                        Name="WatchLaterBtn"/>
                                <Button Content="ðŸ—‘"
                        FontSize="12"
                        Width="40"
                        Height="40"
                        Margin="2"
                        Click="DeleteButton_Click"
                        Tag="{x:Bind}"
                        Name="DeleteBtn"/>
                                <Button Content="âŸ³"
                        FontSize="16"
                        Width="40"
                        Height="40"
                        Margin="2"
                        Click="RefreshMetadataButton_Click"
                        Tag="{x:Bind}"
                        Name="RefreshBtn"/>
                                <Button Content="â„¹"
                        FontSize="12"
                        Width="40"
                        Height="40"
                        Margin="2"
                        Click="DetailsButton_Click"
                        Tag="{x:Bind}"
                        Name="DetailsBtn"/>
                            </StackPanel>

                            <!-- è§†é¢‘æ ‡é¢˜å’Œæ—¶é•¿ -->
                            <TextBlock Text="{x:Bind Title}"
                         FontWeight="Bold"
                         TextWrapping="Wrap"
                         MaxLines="1"
                         Margin="0,2,0,0"/>
                            <TextBlock Text="{x:Bind FormatDuration(Duration)}"
                         FontSize="12"
                         Foreground="Gray"/>
                        </StackPanel>
                    </DataTemplate>
                </GridView.ItemTemplate>
            </GridView>

            <!-- åˆ†é¡µæŽ§ä»¶ -->
            <StackPanel Grid.Row="2"
                  Orientation="Horizontal"
                  HorizontalAlignment="Center"
                  Margin="10">
                <Button x:Name="JumpBackTenPagesButton"
                Content="åŽé€€10é¡µ"
                Click="JumpBackTenPagesButton_Click"
                Margin="5"/>
                <Button x:Name="PreviousPageButton"
                Content="ä¸Šä¸€é¡µ"
                Click="PreviousPageButton_Click"
                Margin="5"/>
                <TextBlock x:Name="PageInfoText"
                   VerticalAlignment="Center"
                   Margin="10,0"/>
                <Button x:Name="NextPageButton"
                Content="ä¸‹ä¸€é¡µ"
                Click="NextPageButton_Click"
                Margin="5"/>
                <Button x:Name="JumpForwardTenPagesButton"
                Content="å‰è¿›10é¡µ"
                Click="JumpForwardTenPagesButton_Click"
                Margin="5"/>
            </StackPanel>
        </Grid>

        <Border Grid.Column="1"
            Margin="0,10,10,10"
            Padding="10"
            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
            BorderBrush="{ThemeResource SystemControlForegroundBaseLowBrush}"
            BorderThickness="1"
            CornerRadius="8">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <StackPanel Orientation="Horizontal"
                    Spacing="8"
                    HorizontalAlignment="Left">
                    <TextBlock Text="ä¸´æ—¶åˆ—è¡¨"
                     FontWeight="Bold"
                     FontSize="16"/>
                    <TextBlock Text="(æœ¬æ¬¡ä¼šè¯)"
                     Foreground="Gray"
                     VerticalAlignment="Center"/>
                </StackPanel>
                <Grid Grid.Row="1">
                    <ListView x:Name="TempVideosListView"
                    IsItemClickEnabled="False"
                    SelectionMode="Multiple"
                    AllowDrop="True"
                    DragOver="TempVideosListView_DragOver"
                    Drop="TempVideosListView_Drop">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="local:VideoModel">
                                <Grid Padding="6" Tapped="TempListItem_Tapped">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Border Width="44"
                          Height="44"
                          Background="LightGray"
                          CornerRadius="4"
                          Margin="0,0,8,0">
                                        <Image Source="{x:Bind GetThumbnailPath(FilePath)}"
                           Stretch="UniformToFill"/>
                                    </Border>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="{x:Bind Title}"
                               FontWeight="SemiBold"
                               TextTrimming="CharacterEllipsis"
                               MaxLines="1"/>
                                        <TextBlock Text="{x:Bind FormatDuration(Duration)}"
                               FontSize="12"
                               Foreground="Gray"/>
                                    </StackPanel>
                                    <Button Grid.Column="2"
                          Content="ç§»é™¤"
                          Margin="8,0,0,0"
                          Click="RemoveTempVideoButton_Click"
                          Tag="{x:Bind}"/>
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                    <TextBlock x:Name="TempListPlaceholder"
                     Text="æ‹–æ‹½è§†é¢‘æˆ–ç‚¹å‡»â€œâž•ä¸´æ—¶â€æ·»åŠ "
                     Foreground="Gray"
                     HorizontalAlignment="Center"
                     VerticalAlignment="Center"
                     TextWrapping="Wrap"
                     Margin="10"/>
                </Grid>
                <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Spacing="8"
                    Margin="0,10,0,0">
                    <Button x:Name="RemoveTempSelectedButton"
                  Content="ä»Žåˆ—è¡¨ç§»é™¤"
                  Click="RemoveTempSelectedButton_Click"/>
                    <Button x:Name="DeleteTempSelectedButton"
                  Content="åˆ é™¤æ–‡ä»¶"
                  Click="DeleteTempSelectedButton_Click"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Page>